<div class="professionals-list-container">
  <div
    class="professionals-header"
    [class.single-result]="displayedProfessionals.length === 1"
    [class.few-results]="displayedProfessionals.length > 1 && displayedProfessionals.length <= 3">
    <span class="professionals-count">{{ professionals.length }} profesionales encontrados</span>
  </div>

  <ion-grid
    class="professionals-grid"
    [class.single-result]="displayedProfessionals.length === 1"
    [class.few-results]="displayedProfessionals.length > 1 && displayedProfessionals.length <= 3">
    <ion-row>
      <ion-col
        *ngFor="let professional of displayedProfessionals; trackBy: trackByProfessionalId"
        size="12"
        size-md="6"
        size-lg="6"
        class="professional-col">
        <ion-card class="professional-card">
          <ion-card-content class="card-content">
            <div class="card-header">
              <div class="avatar-container">
                <div class="avatar">
                  {{ professional.name.charAt(0) }}{{ professional.name.split(' ')[1]?.charAt(0) || '' }}
                </div>
                <!-- <div class="status-indicator" [style.background-color]="getStatusColor(professional)"></div> -->
              </div>
              <div class="professional-info">
                <div class="name-container">
                  <h3 class="professional-name">{{ professional.name }}</h3>
                  <ion-icon
                    *ngIf="professional.isVerified"
                    name="checkmark-circle"
                    class="verified-icon">
                  </ion-icon>
                </div>
                <p class="profession">{{ professional.profession }}</p>
              </div>
            </div>

            <div class="rating-location">
              <div class="rating">
                <div class="stars-container">
                  <ion-icon
                    *ngFor="let star of getStarsArray(professional.rating); let i = index"
                    [name]="star === 'full' ? 'star' : (star === 'half' ? 'star-half' : 'star-outline')"
                    class="star-icon"
                    [class.filled]="star === 'full'"
                    [class.half-filled]="star === 'half'"
                    [class.empty]="star === 'empty'">
                  </ion-icon>
                </div>
                <span class="rating-text">{{ professional.rating }} ({{ professional.reviews }} reseñas)</span>
              </div>
              <div class="location">
                <ion-icon name="location" class="location-icon"></ion-icon>
                <span class="location-text">
                  {{ professional.location }}<ng-container *ngIf="professional.province">, {{ professional.province }}</ng-container>
                </span>
              </div>
            </div>

            <div class="skills-container">
              <ion-chip
                *ngFor="let skill of professional.skills.slice(0, 3)"
                class="skill-tag">
                {{ skill }}
              </ion-chip>
              <ion-chip
                *ngIf="professional.skills.length > 3"
                class="skill-tag more-skills">
                +{{ professional.skills.length - 3 }}
              </ion-chip>
            </div>

              <!-- Sobre mí (resumen) -->
              <div class="about-container" *ngIf="professional.description">
                <p class="about-text">{{ professional.description }}</p>
              </div>

            <div class="card-footer">
              <!-- <div class="price">
                <span class="price-amount">${{ professional.pricePerHour }}</span>
                <span class="price-unit">por hora</span>
              </div> -->
              <ion-button
                class="view-profile-button"
                (click)="onViewProfile(professional)"
                fill="solid"
                color="primary"
                size="small">
                <ion-icon name="eye" slot="start"></ion-icon>
                Ver Perfil
              </ion-button>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Load More Button -->
  <div *ngIf="hasMoreData && !isLoading" class="load-more-container">
    <ion-button
      (click)="loadMore.emit()"
      fill="outline"
      color="primary"
      size="large"
      class="load-more-button">
      Cargar más profesionales
    </ion-button>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading-indicator">
    <ion-spinner name="crescent"></ion-spinner>
    <span>Cargando más profesionales...</span>
  </div>

  <!-- No more data indicator -->
  <div *ngIf="!hasMoreData && displayedProfessionals.length > 0" class="no-more-data">
    <span>No hay más profesionales para mostrar</span>
  </div>
</div>
